<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="csrf-token" content="ZaN7mlqIEI7eyVZualQZKTz3sQXda1vUmKjYWDvu">

    <title>Laravel - Portail Patient</title>

    <link rel="preconnect" href="https://fonts.bunny.net">
    <link href="https://fonts.bunny.net/css?family=figtree:400,500,600&display=swap" rel="stylesheet" />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>

    <link rel="preload" as="style" href="http://127.0.0.1:8000/build/assets/app-BrM9Cw35.css" /><link rel="modulepreload" as="script" href="http://127.0.0.1:8000/build/assets/app-CJy8ASEk.js" /><link rel="stylesheet" href="http://127.0.0.1:8000/build/assets/app-BrM9Cw35.css" /><script type="module" src="http://127.0.0.1:8000/build/assets/app-CJy8ASEk.js"></script></head>
<body class="antialiased bg-gray-50">
    <div class="min-h-screen flex flex-col">
        <!-- Navigation -->
        <nav class="bg-white border-b border-gray-100 shadow-sm">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between h-16">
                    <div class="flex">
                        <!-- Logo -->
                        <div class="shrink-0 flex items-center">
                            <a href="http://127.0.0.1:8000/portal/dashboard" class="text-xl font-bold text-gray-800">
                                Hôpital - Portail Patient
                            </a>
                        </div>

                        <!-- Navigation Links -->
                        <div class="hidden space-x-8 sm:-my-px sm:ml-10 sm:flex">
                            <a class="inline-flex items-center px-1 pt-1 border-b-2 border-transparent text-sm font-medium leading-5 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-700 focus:outline-none focus:text-gray-700 dark:focus:text-gray-300 focus:border-gray-300 dark:focus:border-gray-700 transition duration-150 ease-in-out" href="http://127.0.0.1:8000/portal/dashboard">
    Tableau de bord
</a>
                            <a class="inline-flex items-center px-1 pt-1 border-b-2 border-transparent text-sm font-medium leading-5 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-700 focus:outline-none focus:text-gray-700 dark:focus:text-gray-300 focus:border-gray-300 dark:focus:border-gray-700 transition duration-150 ease-in-out" href="http://127.0.0.1:8000/portal/appointments">
    Rendez-vous
</a>
                            <a class="inline-flex items-center px-1 pt-1 border-b-2 border-transparent text-sm font-medium leading-5 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-700 focus:outline-none focus:text-gray-700 dark:focus:text-gray-300 focus:border-gray-300 dark:focus:border-gray-700 transition duration-150 ease-in-out" href="http://127.0.0.1:8000/portal/documents">
    Documents
</a>
                        </div>
                    </div>

                    <!-- Settings Dropdown -->
                    <div class="hidden sm:flex sm:items-center sm:ml-6">
                        <div class="relative" x-data="{ open: false }" @click.outside="open = false" @close.stop="open = false">
    <div @click="open = ! open">
        <button class="inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-gray-500 bg-white hover:text-gray-700 focus:outline-none transition ease-in-out duration-150">
                                    <div>Sarah Karamoko</div>

                                    <div class="ml-1">
                                        <svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                                        </svg>
                                    </div>
                                </button>
    </div>

    <div x-show="open"
            x-transition:enter="transition ease-out duration-200"
            x-transition:enter-start="opacity-0 scale-95"
            x-transition:enter-end="opacity-100 scale-100"
            x-transition:leave="transition ease-in duration-75"
            x-transition:leave-start="opacity-100 scale-100"
            x-transition:leave-end="opacity-0 scale-95"
            class="absolute z-50 mt-2 w-48 rounded-md shadow-lg ltr:origin-top-right rtl:origin-top-left end-0"
            style="display: none;"
            @click="open = false">
        <div class="rounded-md ring-1 ring-black ring-opacity-5 py-1 bg-white dark:bg-gray-700">
            <a class="block w-full px-4 py-2 text-start text-sm leading-5 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 focus:outline-none focus:bg-gray-100 dark:focus:bg-gray-800 transition duration-150 ease-in-out" href="http://127.0.0.1:8000/portal/profile">Mon Profil</a>

                                <!-- Authentication -->
                                <form method="POST" action="http://127.0.0.1:8000/portal/logout">
                                    <input type="hidden" name="_token" value="ZaN7mlqIEI7eyVZualQZKTz3sQXda1vUmKjYWDvu" autocomplete="off">
                                    <a class="block w-full px-4 py-2 text-start text-sm leading-5 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 focus:outline-none focus:bg-gray-100 dark:focus:bg-gray-800 transition duration-150 ease-in-out" href="http://127.0.0.1:8000/portal/logout" onclick="event.preventDefault();
                                                    this.closest('form').submit();">Se déconnecter</a>
                                </form>
        </div>
    </div>
</div>
                    </div>

                    <!-- Hamburger -->
                    <div class="-mr-2 flex items-center sm:hidden">
                        <button @click="open = ! open" class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 focus:text-gray-500 transition duration-150 ease-in-out">
                            <svg class="h-6 w-6" stroke="currentColor" fill="none" viewBox="0 0 24 24">
                                <path :class="{'hidden': open, 'inline-flex': ! open }" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                                <path :class="{'hidden': ! open, 'inline-flex': open }" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                            </svg>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Responsive Navigation Menu -->
            <div :class="{'block': open, 'hidden': ! open}" class="hidden sm:hidden">
                <div class="pt-2 pb-3 space-y-1">
                    <a class="block w-full ps-3 pe-4 py-2 border-l-4 border-transparent text-start text-base font-medium text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 hover:border-gray-300 dark:hover:border-gray-600 focus:outline-none focus:text-gray-800 dark:focus:text-gray-200 focus:bg-gray-50 dark:focus:bg-gray-700 focus:border-gray-300 dark:focus:border-gray-600 transition duration-150 ease-in-out" href="http://127.0.0.1:8000/portal/dashboard">
    Tableau de bord
</a>
                    <a class="block w-full ps-3 pe-4 py-2 border-l-4 border-transparent text-start text-base font-medium text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 hover:border-gray-300 dark:hover:border-gray-600 focus:outline-none focus:text-gray-800 dark:focus:text-gray-200 focus:bg-gray-50 dark:focus:bg-gray-700 focus:border-gray-300 dark:focus:border-gray-600 transition duration-150 ease-in-out" href="http://127.0.0.1:8000/portal/appointments">
    Rendez-vous
</a>
                    <a class="block w-full ps-3 pe-4 py-2 border-l-4 border-transparent text-start text-base font-medium text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 hover:border-gray-300 dark:hover:border-gray-600 focus:outline-none focus:text-gray-800 dark:focus:text-gray-200 focus:bg-gray-50 dark:focus:bg-gray-700 focus:border-gray-300 dark:focus:border-gray-600 transition duration-150 ease-in-out" href="http://127.0.0.1:8000/portal/documents">
    Documents
</a>
                </div>

                <!-- Responsive Settings Options -->
                <div class="pt-4 pb-1 border-t border-gray-200">
                    <div class="px-4">
                        <div class="font-medium text-base text-gray-800">Sarah Karamoko</div>
                        <div class="font-medium text-sm text-gray-500">karamokoyolesarah@gmail.com</div>
                    </div>

                    <div class="mt-3 space-y-1">
                        <a class="block w-full ps-3 pe-4 py-2 border-l-4 border-transparent text-start text-base font-medium text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 hover:border-gray-300 dark:hover:border-gray-600 focus:outline-none focus:text-gray-800 dark:focus:text-gray-200 focus:bg-gray-50 dark:focus:bg-gray-700 focus:border-gray-300 dark:focus:border-gray-600 transition duration-150 ease-in-out" href="http://127.0.0.1:8000/portal/profile">
    Mon Profil
</a>

                        <!-- Authentication -->
                        <form method="POST" action="http://127.0.0.1:8000/portal/logout">
                            <input type="hidden" name="_token" value="ZaN7mlqIEI7eyVZualQZKTz3sQXda1vUmKjYWDvu" autocomplete="off">
                            <a class="block w-full ps-3 pe-4 py-2 border-l-4 border-transparent text-start text-base font-medium text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 hover:border-gray-300 dark:hover:border-gray-600 focus:outline-none focus:text-gray-800 dark:focus:text-gray-200 focus:bg-gray-50 dark:focus:bg-gray-700 focus:border-gray-300 dark:focus:border-gray-600 transition duration-150 ease-in-out" href="http://127.0.0.1:8000/portal/logout" onclick="event.preventDefault();
                                                this.closest('form').submit();">
    Se déconnecter
</a>
                        </form>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Page Content -->
        <main class="flex-1">
            <div class="py-12" x-data="fileManager({"Imagerie M\u00e9dicale":{"color":"blue","children":{"H\u00f4pital":{"Admission":{"Facture":[],"Ordonnance":[]},"Non Admission":{"Facture":[],"Ordonnance":[]}},"Maison":{"Facture":[],"Ordonnance":[]}}},"Laboratoire":{"color":"green","children":{"H\u00f4pital":{"Admission":{"Facture":[],"Ordonnance":[]},"Non Admission":{"Facture":[],"Ordonnance":[]}},"Maison":{"Facture":[],"Ordonnance":[]}}},"Cardiologie":{"color":"red","children":{"H\u00f4pital":{"Admission":{"Facture":[],"Ordonnance":[]},"Non Admission":{"Facture":[],"Ordonnance":[]}},"Maison":{"Facture":[],"Ordonnance":[]}}},"Consultations G\u00e9n\u00e9rales":{"color":"purple","children":{"H\u00f4pital":{"Admission":{"Facture":[],"Ordonnance":[]},"Non Admission":{"Facture":[],"Ordonnance":[]}},"Maison":{"Facture":[],"Ordonnance":[]}}},"Administration":{"color":"purple","children":{"H\u00f4pital":{"Admission":{"Facture":[],"Ordonnance":[]},"Non Admission":{"Facture":[{"id":"inv-9","type":"Facture","title":"Facture #LAB-2602010120-0001","date":"2026-02-01T01:20:24.000000Z","service":"Administration","context":"H\u00f4pital","status":"Non Admission","file_path":null,"download_route":"http:\/\/127.0.0.1:8000\/portal\/invoices\/9\/download","icon":"fas fa-file-invoice-dollar","color":"text-gray-600"},{"id":"inv-8","type":"Facture","title":"Facture #LAB-2602010118-0001","date":"2026-02-01T01:18:21.000000Z","service":"Administration","context":"H\u00f4pital","status":"Non Admission","file_path":null,"download_route":"http:\/\/127.0.0.1:8000\/portal\/invoices\/8\/download","icon":"fas fa-file-invoice-dollar","color":"text-gray-600"},{"id":"inv-7","type":"Facture","title":"Facture #LAB-2602010117-0001","date":"2026-02-01T01:17:45.000000Z","service":"Administration","context":"H\u00f4pital","status":"Non Admission","file_path":null,"download_route":"http:\/\/127.0.0.1:8000\/portal\/invoices\/7\/download","icon":"fas fa-file-invoice-dollar","color":"text-gray-600"},{"id":"inv-3","type":"Facture","title":"Facture #LAB-260201-0001","date":"2026-02-01T01:09:35.000000Z","service":"Administration","context":"H\u00f4pital","status":"Non Admission","file_path":null,"download_route":"http:\/\/127.0.0.1:8000\/portal\/invoices\/3\/download","icon":"fas fa-file-invoice-dollar","color":"text-gray-600"}],"Ordonnance":[]}},"Maison":{"Facture":[],"Ordonnance":[]}}},"MATERNITE":{"color":"purple","children":{"H\u00f4pital":{"Admission":{"Facture":[],"Ordonnance":[{"id":"vital-pres-6","type":"Ordonnance","title":"Ordonnance (Dossier) du 01\/02\/2026","date":"2026-02-01T00:17:36.000000Z","service":"MATERNITE","context":"H\u00f4pital","status":"Admission","file_path":null,"download_route":"http:\/\/127.0.0.1:8000\/portal\/prescriptions\/6\/download","icon":"fas fa-file-medical","color":"text-blue-600"}]},"Non Admission":{"Facture":[{"id":"inv-2","type":"Facture","title":"Facture #INV-260131-0002","date":"2026-01-31T23:22:51.000000Z","service":"MATERNITE","context":"H\u00f4pital","status":"Non Admission","file_path":null,"download_route":"http:\/\/127.0.0.1:8000\/portal\/invoices\/2\/download","icon":"fas fa-file-invoice-dollar","color":"text-gray-600"}],"Ordonnance":[{"id":"pres-1","type":"Ordonnance","title":"Ordonnance du 01\/02\/2026","date":"2026-02-01T16:25:24.000000Z","service":"MATERNITE","context":"H\u00f4pital","status":"Non Admission","file_path":null,"download_route":"http:\/\/127.0.0.1:8000\/portal\/prescriptions\/1\/download","icon":"fas fa-prescription-bottle-alt","color":"text-blue-600"}]}},"Maison":{"Facture":[],"Ordonnance":[]}}},"Medecin g\u00e9n\u00e9rale":{"color":"purple","children":{"H\u00f4pital":{"Admission":{"Facture":[],"Ordonnance":[]},"Non Admission":{"Facture":[{"id":"inv-1","type":"Facture","title":"Facture #INV-260131-0001","date":"2026-01-31T17:56:36.000000Z","service":"Medecin g\u00e9n\u00e9rale","context":"H\u00f4pital","status":"Non Admission","file_path":null,"download_route":"http:\/\/127.0.0.1:8000\/portal\/invoices\/1\/download","icon":"fas fa-file-invoice-dollar","color":"text-gray-600"}],"Ordonnance":[]}},"Maison":{"Facture":[],"Ordonnance":[]}}}})">
        <div class="max-w-7xl mx-auto sm:px-6 lg:px-8">
            <div class="bg-white overflow-hidden shadow-xl sm:rounded-lg min-h-[500px] flex flex-col border border-gray-200">
                
                <div class="bg-gray-50 border-b border-gray-200 px-6 py-4 flex items-center space-x-2 overflow-x-auto">
                    <button @click="resetPath()" class="p-2 rounded-lg hover:bg-gray-200 text-gray-600 transition-colors">
                        <i class="fas fa-home"></i>
                    </button>
                    
                    <span class="text-gray-400" x-show="currentPath.length > 0"><i class="fas fa-chevron-right text-xs"></i></span>

                    <template x-for="(crumb, index) in currentPath" :key="index">
                        <div class="flex items-center">
                            <button @click="goToLevel(index)" 
                                    class="px-3 py-1 rounded-md font-medium text-sm transition-colors hover:bg-blue-100 hover:text-blue-700"
                                    :class="index === currentPath.length - 1 ? 'text-gray-900 font-bold bg-white shadow-sm' : 'text-gray-600'"
                                    x-text="crumb">
                            </button>
                            <span class="mx-2 text-gray-400" x-show="index < currentPath.length - 1">
                                <i class="fas fa-chevron-right text-xs"></i>
                            </span>
                        </div>
                    </template>

                    <div x-show="currentPath.length === 0" class="text-gray-400 italic text-sm ml-2">
                        Vue d'ensemble des Services
                    </div>
                </div>

                <div class="p-6 flex-1 bg-white">
                    <div x-show="viewType === 'folders'" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                        <template x-for="(item, key) in currentLevelItems" :key="key">
                            <div @click="enterFolder(key)" 
                                 class="group cursor-pointer border border-gray-100 rounded-2xl p-6 bg-gray-50 hover:bg-white hover:shadow-lg hover:border-blue-100 transition-all duration-200 flex flex-col items-center justify-center text-center relative overflow-hidden">
                                
                                <div class="absolute -right-4 -bottom-4 text-9xl text-gray-200 opacity-20 transform group-hover:scale-110 transition-transform duration-500 pointer-events-none">
                                    <i :class="getIcon(key)"></i>
                                </div>

                                <div class="w-16 h-16 rounded-2xl flex items-center justify-center mb-4 transition-colors duration-300"
                                     :class="getColorClass(key, item)">
                                    <i :class="getIcon(key)" class="text-3xl"></i>
                                </div>

                                <h3 class="font-bold text-gray-800 text-lg group-hover:text-blue-600 transition-colors" x-text="key"></h3>
                                <p class="text-xs text-gray-500 mt-1 font-medium" x-text="getSubLabel(item)"></p>
                            </div>
                        </template>

                        <div x-show="Object.keys(currentLevelItems).length === 0" class="col-span-full text-center py-12 text-gray-400">
                            <i class="fas fa-folder-open text-4xl mb-3 opacity-50"></i>
                            <p>Ce dossier est vide.</p>
                        </div>
                    </div>

                    <div x-show="viewType === 'files'" class="space-y-4">
                        <template x-for="doc in filesList" :key="doc.id">
                            <div class="flex flex-col md:flex-row items-start md:items-center p-4 border border-gray-100 rounded-xl hover:bg-gray-50 transition-colors hover:border-blue-200 group">
                                <div class="w-12 h-12 rounded-lg bg-blue-50 text-blue-600 flex items-center justify-center mr-4 group-hover:scale-110 transition-transform">
                                    <i :class="doc.icon || 'fas fa-file-alt'"></i>
                                </div>
                                <div class="flex-1">
                                    <h4 class="font-bold text-gray-900 group-hover:text-blue-700 transition-colors" x-text="doc.title"></h4>
                                    <div class="flex items-center text-xs text-gray-500 mt-1 space-x-3">
                                        <span><i class="far fa-calendar mr-1"></i> <span x-text="formatDate(doc.date)"></span></span>
                                        <span class="bg-gray-200 px-2 py-0.5 rounded text-gray-600" x-text="doc.type"></span>
                                    </div>
                                </div>
                                <div class="mt-3 md:mt-0">
                                    <a :href="doc.download_route" class="px-3 py-1.5 bg-blue-600 text-white text-xs font-bold rounded-lg hover:bg-blue-700 transition shadow-sm flex items-center">
                                        <i class="fas fa-download mr-1.5"></i> Télécharger
                                    </a>
                                </div>
                            </div>
                        </template>
                        <div x-show="filesList.length === 0" class="text-center py-12 text-gray-400">
                            <p>Aucun document dans ce dossier.</p>
                        </div>
                    </div>
                </div>

                <div class="bg-gray-50 border-t border-gray-200 px-6 py-3 text-xs text-gray-500 flex justify-between">
                    <span>
                        <span class="font-bold" x-text="viewType === 'folders' ? Object.keys(currentLevelItems).length : filesList.length"></span> éléments
                    </span>
                    <span x-text="currentPath.join(' / ') || '/'"></span>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('alpine:init', () => {
            Alpine.data('fileManager', (initialData) => ({
                data: initialData,
                currentPath: [],
                viewType: 'folders',
                
                init() {
                    if (typeof this.data === 'string') {
                        this.data = JSON.parse(this.data);
                    }
                },

                get currentLevelItems() {
                    let current = this.data;
                    for (let folder of this.currentPath) {
                        if (!current[folder]) return {};
                        current = current[folder].children ? current[folder].children : current[folder];
                    }
                    if (Array.isArray(current)) {
                        this.viewType = 'files';
                        return {};
                    }
                    this.viewType = 'folders';
                    return current || {};
                },

                get filesList() {
                    let current = this.data;
                    for (let folder of this.currentPath) {
                        if (!current[folder]) return [];
                        current = current[folder].children ? current[folder].children : current[folder];
                    }
                    return Array.isArray(current) ? current : [];
                },

                enterFolder(key) {
                    this.currentPath.push(key);
                },

                goToLevel(index) {
                    this.currentPath = this.currentPath.slice(0, index + 1);
                },

                resetPath() {
                    this.currentPath = [];
                },

                formatDate(dateString) {
                    if(!dateString) return '';
                    return new Date(dateString).toLocaleDateString('fr-FR', { day: '2-digit', month: 'long', year: 'numeric' });
                },

                getIcon(key) {
                    const k = key.toLowerCase();
                    if (k.includes('maison')) return 'fas fa-home';
                    if (k.includes('hôpital')) return 'fas fa-hospital-alt';
                    if (k.includes('admission')) return 'fas fa-bed';
                    if (k.includes('lab')) return 'fas fa-flask';
                    return 'fas fa-folder';
                },

                getSubLabel(item) {
                    if (Array.isArray(item)) return item.length + ' documents';
                    let target = item.children ? item.children : item;
                    return Object.keys(target).length + ' éléments';
                },

                getColorClass(key, item) {
                    if (item.color === 'blue') return 'bg-blue-100 text-blue-600';
                    if (item.color === 'green') return 'bg-green-100 text-green-600';
                    if (item.color === 'red') return 'bg-red-100 text-red-600';
                    return 'bg-indigo-100 text-indigo-600';
                }
            }));
        });
    </script>
        </main>
    </div>

    <!-- Flash Messages -->
    
    
    </body>
</html>